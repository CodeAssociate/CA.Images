



#trigger:
#- main

#pool:
#  vmImage: 'windows-latest'

#variables:
#  solution: '**/*.sln'
#  buildPlatform: 'Any CPU'
#  buildConfiguration: 'Release'
#  Major: '1'
#  Minor: '0'
#  Patch : $[counter(variables['BuildID'], 0)]
#  SemanticVerion : $(Major).$(Minor).$(Patch)

#steps:
#- script: echo $(SemanticVerion)


##Set the assembly file and version numbers to be the build number
#- task: PowerShell@2
#  inputs:
#    targetType: 'inline'
#    workingDirectory: '$(Build.SourcesDirectory)\CA.Blocks.Images\'
#    script: '((Get-Content -path CA.Blocks.Images.csproj -Raw) -replace "987.654.3210","$(SemanticVerion)") | Set-Content -Path CA.Blocks.Images.csproj'

#- task: PowerShell@2
#  inputs:
#    targetType: 'inline'
#    workingDirectory: '$(Build.SourcesDirectory)\CA.Images\'
#    script: '((Get-Content -path CA.Images.csproj -Raw) -replace "987.654.3210","$(SemanticVerion)") | Set-Content -Path CA.Images.csproj'


#- task: NuGetToolInstaller@1

#- task: NuGetCommand@2
#  inputs:
#    restoreSolution: '$(solution)'

#- task: VSBuild@1
#  inputs:
#    solution: '$(solution)'
#    platform: '$(buildPlatform)'
#    configuration: '$(buildConfiguration)'

#- task: VSTest@2
#  inputs:
#    testSelector: 'testAssemblies'
#    testAssemblyVer2: |
#        **\CA.Blocks.ImagesUnitTests.dll
#        !**\obj\**
#        !**\bin\**\ref\**
#    platform: '$(buildPlatform)'
#    configuration: '$(buildConfiguration)'

#    codeCoverageEnabled: True # Optional


#- task: DotNetCoreCLI@2
#  inputs:
#    command: 'pack'
#    packagesToPack: '**/*.csproj;!**/*Tests.csproj;!**/*CA.Images.csproj'
#    packDirectory: '$(Build.ArtifactStagingDirectory)'
#    versioningScheme: byEnvVar
#    versionEnvVar : SemanticVerion


#- task: DotNetCoreCLI@2
#  displayName: 'dotnet publish'
#  inputs:
#    command: 'publish'
#    publishWebProjects: False
#    projects: '**/*CA.Images.csproj'
#    arguments: '-o $(Build.ArtifactStagingDirectory)/Output'


##- task: CopyFiles@2
##  displayName: 'Copy $(Build.SourcesDirectory)\CA.Images\bin\Release\net5.0\*.*'
##  inputs:
##    contents: '$(Build.SourcesDirectory)\CA.Images\bin\Release\net5.0\win-x64\publish\CA.Images.exe'
##    targetFolder: $(Build.artifactstagingdirectory)


#- task: PublishBuildArtifacts@1    
#  displayName: 'Publish Artifact: drop'
#  inputs:
#    PathtoPublish: '$(build.artifactstagingdirectory)'